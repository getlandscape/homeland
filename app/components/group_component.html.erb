<% cache([group, group.avatar]) do %>
  <div class="group topic media topic-<%= group.id %>" data-prefetch="<%= main_app.group_path(group) %>">
    <div class="avatar">
      <% if group.avatar_url.present? %>
        <%= user_avatar_tag(group, :md) %>
      <% end %>
    </div>
    <div class="infos media-body">
      <div class="title media-heading">
        <% if group.group_member? current_user %>
          <%= link_to(main_app.topics_group_path(group), title: group.name) do %>
            <%= group.name %>
          <% end %>
        <% else %>
          <%= link_to(main_app.group_path(group), title: group.name) do %>
            <%= group.name %>
          <% end %>
        <% end %>
      </div>
      <div class="info">
        <%= group.description %>
      </div>
    </div>
    <div class="count media-right">
      <% group_user = group.group_users.where(user_id: current_user.id).last if current_user.present? %>
      <% if group_user.present? %>
        <% if group_user.accepted? %>
          <%= link_to('Joined', main_app.quite_group_group_users_path(group_id: group.id), method: :post) %>
        <% elsif group_user.pendding? %>
          <%= link_to('Waiting', main_app.group_path(group)) %>
        <% end %>
      <% else %>
        <%= link_to('Apply to join', main_app.join_group_group_users_path(group_id: group.id), method: :post) %>
      <% end %>
    </div>
  </div>
<% end %>